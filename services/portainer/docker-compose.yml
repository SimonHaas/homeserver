version: "3.6"
services:
    portainer:
      image: portainer/portainer
      volumes:
        - /var/run/docker.sock:/var/run/docker.sock
        - ./data:/data
      container_name: portainer
      restart: always
      networks: 
          - traefik
      security_opt:
          - no-new-privileges:true
      labels:
          - "traefik.enable=true"
          - "traefik.http.services.portainer.loadbalancer.server.port=9000"
          - "traefik.http.routers.portainer.rule=Host(`${SUB_DOMAIN}.${SERVER_DOMAIN}`)"
          - "traefik.http.routers.portainer.entrypoints=websecure"
          - "traefik.http.routers.portainer.tls.certresolver=myresolver"

networks:
    traefik:
        name: traefik