version: '3'
services:
  filebrowser:
    image: filebrowser/filebrowser:v2.17.2
    user: 0:0
    volumes:
      - ..:/srv
      - ../filebrowser/filebrowser.db:/database.db # file must already exist
    security_opt:
      - no-new-privileges:true #TODO also add for other services
    container_name: filebrowser
    restart: always
    networks: 
        - traefik
    labels:
        - "traefik.enable=true"
        - "traefik.http.services.filebrowser.loadbalancer.server.port=80"
        - "traefik.http.routers.filebrowser.rule=Host(`${SUB_DOMAIN}.${SERVER_DOMAIN}`)"
        - "traefik.http.routers.filebrowser.entrypoints=websecure"
        - "traefik.http.routers.filebrowser.tls.certresolver=myresolver"

networks:
    traefik:
        name: traefik